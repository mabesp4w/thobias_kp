import{r as p,j as a,D as b,b as k,c as v,B as _,aI as e,aN as w}from"./app-CSgTi1V-.js";import{u as C}from"./Orders-Bqfw1Kuz.js";const D=({setOpenDialog:n,openDialog:u,carts:r,user:o,shipping:d,MIDTRANS_CLIENT_KEY:m})=>{const[f,y]=p.useState(!1),{addData:h}=C();p.useEffect(()=>{const s=document.createElement("script");return s.src="https://app.sandbox.midtrans.com/snap/snap.js",s.setAttribute("data-client-key",m||""),s.onload=()=>y(!0),document.body.appendChild(s),()=>{document.body.removeChild(s)}},[]);const j=async()=>{const s=r.reduce((g,l)=>g+l.product.price*l.quantity,0),c=s+d.shipping_cost,i={user_id:o==null?void 0:o.id,shipping_cost_id:d.id,total_price:s,total_payment:c,status:"tunggu",carts:r},t=await h(i);console.log({res:t}),t.status==="success"&&(n(!1),x(t.data.data),e.visit("/orders"))},x=async s=>{if(!f){alert("Snap.js is not loaded yet!");return}const i=(await w.post("/payment",{order_id:s.id})).data;window.snap.pay(i,{onSuccess:function(t){console.log({result:t}),e.visit("/orders")},onPending:function(t){console.log({result:t}),e.visit("/orders")},onError:function(t){console.log({result:t}),e.visit("/orders")},onClose:function(){console.log("user closed the popup")}})};return a.jsxs(b,{openDialog:u,setOpenDialog:n,title:"Lanjut Ke Proses Pembayaran ?",children:[a.jsx("p",{children:"Anda tidak dapat mengubah pesanan setelah melanjutkan ke proses pembayaran."}),a.jsx(k,{children:a.jsxs("div",{className:"w-full flex gap-x-2 justify-center items-end",children:[a.jsx(v,{addClass:"bg-primary",onClick:j,children:"Lanjut"}),a.jsx(_,{variant:"outline",onClick:()=>n(!1),children:"Tidak"})]})})]})};export{D as default};
