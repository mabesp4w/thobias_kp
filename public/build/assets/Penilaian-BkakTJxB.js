import{r as o,j as s,u as y,D as N,a as R,aA as w,I as S,b as $,L as D,c as C,d as I,aI as L}from"./app-CJdbH9Yc.js";import{R as E}from"./RatingStars-DWhW30re.js";import{u as A}from"./Reviews-CYSoTmna.js";const k=({totalStars:n=5,onChangeRating:e,name:c})=>{const[r,d]=o.useState(0),m=l=>{d(l),e(l)};return s.jsx("div",{className:"flex",children:[...Array(n)].map((l,t)=>s.jsx(B,{selected:t<r,onClick:()=>m(t+1),name:`${c}-${t+1}`},t))})},B=({selected:n,onClick:e})=>s.jsx("div",{className:`cursor-pointer ${n?"text-yellow-500":"text-gray-400"}`,onClick:e,children:"â˜…"}),V=({openDialog:n,setOpenDialog:e,user_id:c,order:r})=>{const[d,m]=o.useState(!1);o.useState(0);const{addData:l,setShowReviews:t,dtReviews:i}=A(),v=async()=>{await t(r.id)};o.useEffect(()=>{v()},[]),console.log({dtReviews:i});const{register:u,handleSubmit:x,setValue:F,control:_,formState:{errors:P},watch:K}=y(),h=async a=>(a.user_id=c,a.order_id=r.id,console.log({row:a}),await I({row:a,addData:l,setIsLoading:m,setShowModal:e}),e(!1),L.visit("/orders"));return s.jsxs(N,{openDialog:n,setOpenDialog:e,title:"Penilaian",children:[i.length>0&&s.jsx("div",{className:"flex flex-col gap-y-4",children:i.map(a=>s.jsxs("div",{className:"flex flex-col border-b shadow-md",children:[s.jsx("h1",{children:a.product.product_nm}),s.jsx("p",{children:s.jsx(E,{rating:a.rating})}),s.jsx("p",{children:a.comment})]},a.id))}),i.length===0&&s.jsxs("form",{onSubmit:x(h),children:[s.jsx("div",{className:"grid grid-cols-8 gap-2 mb-4 gap-y-10",children:r.order_items.map((a,g)=>{var p;const j=(p=a==null?void 0:a.product)==null?void 0:p.product_image[0],b=j?`${R}/${j.product_img}`:"/images/no_image.png";return s.jsxs("div",{className:"flex flex-col col-span-8",children:[s.jsxs("div",{className:"flex border-y h-24 col-span-8 items-center",children:[s.jsx("img",{src:b,alt:a.product.product_nm,className:"h-24 object-cover"}),s.jsx("div",{className:"ml-4 w-full",children:s.jsx("h1",{className:"",children:a.product.product_nm})})]}),s.jsx("div",{className:"col-span-8",children:s.jsx(w,{name:`rating[${g}]`,control:_,render:({field:f})=>s.jsx(k,{totalStars:5,onChangeRating:f.onChange,name:f.name})})}),s.jsx(S,{name:`product_id[${g}]`,register:u,type:"hidden",value:a.product_id}),s.jsx(S,{label:"Komentar",name:`comment[${g}]`,register:u,addClass:"col-span-8"})]},a.id)})}),s.jsx($,{children:d?s.jsx(D,{}):s.jsx(C,{onClick:x(h),type:"submit",children:"Simpan"})})]})]})};export{V as default};
